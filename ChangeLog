2009-02-15  Sven Neumann  <sven@gimp.org>

	* Made 2.6.5 release.

2009-02-13  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 571628 – Scaling image to 25% turn background from white to grey

	* app/paint-funcs/scale-region.c (pixel_average2): fixed right-shift
	for GRAYA pixels.

2009-02-12  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	* plug-ins/file-faxg3/Makefile.am
	* plug-ins/help/Makefile.am
	* plug-ins/metadata/Makefile.am: add $(libgimpconfig) to LDADD
	where it was missing. Libgimp pulls in libgimpconfig and these
	plug-ins were linking against the installed libgimpconfig under
	some #$&%*#%&%$& .la file circumstances.

2009-02-12  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	Bug 567840 – GIMP's GtkScaleButton conflicts with GTK's

	* app/widgets/gtkscalebutton.c: rename the type to
	"GimpGtkScaleButton" so we don't crash if the real
	GtkScaleButton type is registered too.

2009-01-29  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/core/gimpchannel-combine.c (gimp_channel_combine_ellipse_rect):
	fixed incorrect optimization that caused glitches in the rounded
	corners on the left side of rectangular selections.

2009-01-28  Sven Neumann  <sven@gimp.org>

	* app/tools/gimpgegltool.c (gimp_param_spec_duplicate): if
	compiling for GEGL >= 0.0.23, use double parameters with
	gegl_color_get_rgba().

2009-01-26  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	* libgimpwidgets/gimpbutton.c (gimp_button_clicked): chain up if a
	parent impl exists to be safe against future gtk versions doing
	something in GtkButton::clicked() (as happened in GTK+ trunk).

2009-01-25  Sven Neumann  <sven@gimp.org>

	Bug 569043 – GEGL tool - missing Operation Settings for all sub-tools

	Merged from trunk:

	* app/tools/gimpgegltool.c (gimp_gegl_tool_get_config): 
	(gimp_gegl_tool_get_config): canonicalize the type name of the
	created config class.

2009-01-24  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	Bug 568890 – don't rely on GtkAction implementation details

	* app/widgets/gimpuimanager.c (gimp_ui_manager_menu_item_select):
	use gtk_widget_get_action() instead of g_object_get_data(),
	which relies on the name of the data key.

2009-01-23  Kevin Cozens  <kcozens@cvs.gimp.org>

	Bug 568909 – wrong RGB values for color names in
	libgimpcolor/gimprgb-parse.c

	Merged from trunk:

	* libgimpcolor/gimprgb-parse.c: applied patch from Andreas Turtschan
	to fix more RGB colour values.

2009-01-23  Kevin Cozens  <kcozens@cvs.gimp.org>

	Bug 568839 – wrong hex RGB value for the color names slategrey and
	slategray

	Merged from trunk:

	* libgimpcolor/gimprgb-parse.c: applied patch from Andreas Turtschan
	to fix colour values for slategray and slategrey.

2009-01-22  Tor Lillqvist  <tml@iki.fi>

	Bug 559408 - Brushes dragged to the image window look strange 

	* app/widgets/gimppixbuf.c (gimp_pixbuf_format_compare): Drop
	Windows-specific code to prefer BMP. The BMP format written by
	gdk-pixbuf doesn't support alpha. PNG is better. Note that the
	same bug report also takes up a different problem.

2009-01-18  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 563337 – Rectangle Select Tool does not allow 1:1 fixed ratio

	* libgimpwidgets/gimpnumberpairentry.c: When testing if the value
	changed on focus-out we shall test against the current values, not
	the default values.

2009-01-17  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 568016 – Black pullout parameter of plug-in-newsprint has
	no effect

	* plug-ins/common/newsprint.c: fixed the documentation of the
	colorspace parameter.

2009-01-13  Sven Neumann  <sven@gimp.org>

	* INSTALL
	* autogen.sh
	* configure.in: looks like we need intltool >= 0.36.3 (and we
	recommend using an even newer version).

2009-01-04  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 562818 – First image opened in GIMP offset

	* app/display/gimpdisplayshell.c (gimp_display_shell_shrink_wrap):
	Only rely on disp_width/height for border calculation if they are
	larger than 1. If not, special-case the calculation so we don't
	get a severly mispositioned image.

2009-01-04  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 562213 – Align Tool doesn't work properly if it is the active
	tool at startup

	* app/tools/gimpaligntool.c: Perform NULL-pointer dodging to avoid
	crashing.

2009-01-01  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.6.5 (interface age 5).

2009-01-01  Sven Neumann  <sven@gimp.org>

	* Made 2.6.4 release.

2009-01-01  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 565223 – Perspective transformation jagged edges / comb effect

	* app/core/gimp-transform-region.c: reverted the code change, but
	not the cleanups, from commit r26786.

2008-12-28  Sven Neumann  <sven@gimp.org>

	* app/tools/gimpgegltool.c (gimp_param_spec_duplicate): fixed
	handling of GEGL minor version number in compile-time check.

2008-12-28  Sven Neumann  <sven@gimp.org>

	* app/tools/gimpgegltool.c (gimp_param_spec_duplicate): fixed typo
	in GEGL version number check.

2008-12-28  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 563985 – jpg save dialog: "cancel" is treated like "commit"
	for settings

	* plug-ins/file-jpeg/jpeg.c (run): only attach the comment and
	settings to the image if the save was successful.

2008-12-27  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 564087 – Using clone tool on a layer with a part out of canvas
	causes crashes

	* app/paint/gimppaintcore.c (gimp_paint_core_paste): intersect the
	rectangle with the extents of the saved projection.

2008-12-27  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 564593 – crash when the drawable is changed while a color
	tools is active

	* app/core/gimpdrawable-shadow.c (gimp_drawable_merge_shadow_tiles):
	keep a reference to the shadow tiles because it might otherwise be
	free'd under our feet.

2008-12-21  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 564869 – GIMP crashes on selecting Tools->GEGL operation

	* app/tools/gimptool.c (gimp_tool_initialize): check if the tool
	has set an error.

2008-12-21  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 565138 – python-fu-foggify does not check if image is in rgb mode

	* plug-ins/pygimp/plug-ins/foggify.py (foggify): fixed handling of
	grayscale images.

2008-12-04  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 563130 – Hue selection mode does not cross the 0-360 degrees line

	* app/core/gimpimage-contiguous-region.c (pixel_difference):
	applied patch from Daniel Hornung.

2008-12-04  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 563179 – Scrollbars not resized when we extend the canvas size

	* app/display/gimpdisplayshell-handlers.c
	(gimp_display_shell_size_changed_detailed_handler): Add explicit
	call to gimp_display_shell_scroll_clamp_and_update() at the end to
	make sure it is called.

2008-12-04  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* tools/pdbgen/pdb/convert.pdb: fixed an error in the documentation
	of the gimp-image-convert-rgb procedure.

	* app/pdb/convert-cmds.c
	* libgimp/gimpconvert_pdb.c: regenerated.

2008-12-03  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimagemap.c (gimp_image_map_apply): when compiling
	against GEGL from trunk, use "gegl:translate" instead of "shift".

2008-11-27  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 562459 – PF_PALETTE: 'TypeError' when used in a plugin that is
	registered in <Image>

	* plug-ins/pygimp/gimpui.defs (gimp_palette_select_button_new):
	the 'title' parameter is optional.

2008-11-27  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	Bug 562427 – Compilation with --as-needed

	* app/Makefile.am (gimp_console_2_7_LDADD): add $(GLIB_LIBS) so
	libgthread gets pulled in explicitely.

2008-11-27  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 562386 – PF_SLIDER and PF_SPINNER 'Step' values do not change
	consistently...

	* plug-ins/pygimp/gimpfu.py (SliderEntry): set the precision on
	the slider just as we do it for the spin-button.

2008-11-27  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* plug-ins/pygimp/gimpfu.py (SpinnerEntry): let SpinnerEntry
	return a float instead of trying to convert the value to an int.

2008-11-27  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 562386 – PF_SLIDER and PF_SPINNER 'Step' values do not change
	consistently...

	* plug-ins/pygimp/gimpfu.py (SpinnerEntry): initialize the
	spin-button the way that gtk_spin_button_new_with_range() is
	implemented.

2008-11-26  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 562366 – Default image dimensions are not correctly
	transferred in the file/new dialog box

	* app/dialogs/preferences-dialog.c
	(prefs_template_select_callback): We need to copy the template in
	the same way as in the New Image dialog.

	* app/dialogs/image-new-dialog.c (image_new_dialog_set): ... and
	when we copy the template to the New Image dialog.

2008-11-22  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 561899 – GIMP can't save to mounted filesystem if file exists

	* plug-ins/file-uri/uri-backend-gvfs.c (copy_uri): pass the
	G_FILE_COPY_OVERWRITE flag to g_file_copy().

2008-11-21  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.6.4 (interface age 4).

2008-11-21  Sven Neumann  <sven@gimp.org>

	* Made 2.6.3 release.

2008-11-19  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 558454 – Plugin Map Color Range disappears from GIMP

	* plug-ins/script-fu/scripts/Makefile.am

	* plug-ins/script-fu/scripts/plug-in-compat.init: new file
	providing compatibility with plug-ins from older GIMP
	versions. Contains a reimplementation of plug-in-color-map based
	on ideas and code from Eric Lamarque.

	* plug-ins/script-fu/scheme-wrapper.c (tinyscheme_init): load the
	plug-in-compat.init file.

2008-11-18  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 559239 – Error while loading psd-data

	* plug-ins/file-psd/psd-layer-res-load.c (load_layer_resource):
	Layer resource data should not be padded.

2008-11-15  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/display/gimpdisplayshell-scroll.[ch]: removed function
	gimp_display_shell_scroll_get_scaled_viewport_offset() as it was
	only returning -shell->offset_x and -shell->offset_y and it
	started to show up in profiles.

	* app/display/gimpdisplayshell-draw.c
	* app/display/gimpdisplayshell-transform.c
	* app/display/gimpdisplayshell-scale.c: use the shell offsets
	directly.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 560903 – Explicit zooming with e.g. '1' should handle
	zoom-focus better

	* app/display/display-enums.h: Added
	GIMP_ZOOM_FOCUS_RETAIN_CENTERING_ELSE_BEST_GUESS.

	* app/display/gimpdisplayshell-scale.c
	(gimp_display_shell_scale_get_zoom_focus): Take the new enum into
	account; if the image is centered, keep it centered, else use the
	best-guess method.

	* app/actions/view-commands.c (view_zoom_explicit_cmd_callback):
	Use the new enum for explicit zooming.

	* app/display/display-enums.c: Regenerated.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 560245 – Zoom selection always centered in the Navigation tab

	* app/display/gimpdisplayshell-scale.c (gimp_display_shell_scale):
	Also take the image center and not only the zoom focus point into
	account when deciding whether or not to center the image after
	zoom.

2008-11-14  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/display/gimpdisplayshell-preview.c
	(gimp_display_shell_draw_quad): check that the resulting area has
	positive width and height.

2008-11-13  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 559292 – SOTA Chrome cannot accept different textures

	* app/pdb/gimppdb-utils.c (gimp_pdb_image_is_base_type)
	(gimp_pdb_image_is_not_base_type): gimp_object_get_name() may 
	return NULL for images. Use gimp_image_get_uri() instead.

2008-11-11  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 560375 – Clearing an already empty document history crashes GIMP

	* app/actions/documents-commands.c (documents_clear_cmd_callback):
	gtk_recent_manager_purge_items() may return 0 but not set an
	error.

2008-11-11  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	Bug 559580 – Image windows need better default locations

	* app/display/gimpdisplayshell.c (gimp_display_shell_style_set):
	Only set GDK_HINT_USER_POS on the empty display because it gets a
	position set by gimp. All other displays should be placed by the
	window manager. Fixes all displays appearing at 0,0.

2008-11-11  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 560283 – "Scale image..." causes distortion around edges.

	* app/paint-funcs/scale-region.c (scale): corrected fix for
	bug #556248.

2008-11-11  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* plug-ins/common/file-pdf.c: fixed size of the GimpParam array
	used for the return values.

2008-11-10  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 559716 – Changing crop size in Crop Tool Options can make UI
	unresponsive

	* app/tools/gimprectangletool.c: Accept a broader range of x, y,
	width and height values from the tool options so we don't end up
	in an infinite signal emission loop.

2008-11-10  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	* app/core/gimpdrawable-curves.c (gimp_drawable_curves_explicit):
	use GIMP_CURVE_FREE, not _SMOOTH. Fixes the resp. PDB call.

2008-11-09  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 558549 – Stroking a single-point path with a paint tool
	crashes GIMP

	* app/paint/gimppaintcore-stroke.c
	(gimp_paint_core_stroke_vectors): Return an error message if there
	were not enough points to stroke.

	* app/dialogs/stroke-dialog.c (stroke_dialog_response): Guard
	against crashes if an implementator forgets to set an error.

2008-11-09  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	* app/display/gimpdisplayshell-scale.c
	(gimp_display_shell_scale_update_rulers): Avoid critical warnings
	when converting an image window with a unit other than pixels into
	a the empty image window. Probably fixes some of the crashes
	reported by Windows users.

2008-11-04  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/display/gimpdisplayshell-dnd.c
	(gimp_display_shell_drop_uri_list): when dropping multiple images
	to the empty image window, open them as seperate images.

2008-11-04  Sven Neumann  <sven@gimp.org>

	* app/file/file-procedure.c
	* app/file/file-save.c
	* app/pdb/gimpprocedure.c: be careful when passing literal strings
	to g_set_error().

2008-11-03  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	Bug 559015 – Move tool gives bad information about px moved

	* app/tools/gimpeditselectiontool.c (gimp_edit_selection_tool_init):
	set cursor precision to PIXEL_BORDER because that's what the move
	tool snaps to.

	Unrelated: set CENTER_CROSS_SIZE to an odd number so it's drawn
	symmetrically.

2008-10-31  Sven Neumann  <sven@gimp.org>

	Bug 558660 – help behavior for locales without manual translation

	* app/widgets/gimphelp.c (gimp_help_user_manual_is_installed):
	as a fallback check for the english user manual.

2008-10-30  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.6.3 (interface age 3).

2008-10-30  Sven Neumann  <sven@gimp.org>

	* Made 2.6.2 release.

2008-10-30  Sven Neumann  <sven@gimp.org>

	Backed out this change for now as it causes problem with some
	window managers:

        Bug 556896 – Dialogs don't get minimized with single image window

	* app/display/gimpdisplayshell.c
	* app/display/gimpdisplay-foreach.[ch]
	* app/widgets/gimpdialogfactory.[ch]: merged changes from trunk.
	Hide the toolbox and docks if the last display is iconified.
	Unhide them if a display is uniconified.

2008-10-29  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 557950 – Scaling in Gimp 2.6 is much slower than in Gimp 2.4

        * app/paint-funcs/scale-region.c: don't do multi-pass scaling
	when we are scaling up.

2008-10-29  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 558215 – unit and zoom entries in Statusbar not visible

	* app/display/gimpdisplayshell-callbacks.c
	(gimp_display_shell_canvas_size_allocate): Don't try to be clever,
	call gimp_display_shell_scaled() whenever the canvas size changes
	so a newly created display shell gets updated properly.

2008-10-29  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 558451 – Cannot build GIMP using Sun CC on Solaris 2.8

	* app/pdb/gimp-pdb-compat.c
	* app/gegl/gimpoperationtilesink.c
	* app/gegl/gimpoperationtilesource.c
	* app/tools/gimpgegltool.c: applied patches from Eric Lamarque
	fixing the build using Sun CC on Solaris.

2008-10-29  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 558420 – projection incorrect with alpha-less layers

	* app/core/gimpprojection-construct.c (gimp_projection_initialize):
	need to initialize the projection if the covering layer is not
	opaque.

2008-10-28  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 556603 – Zoom region always zooms in center of image

	* app/tools/gimpmagnifytool.c (gimp_magnify_tool_button_release):
	When zooming with a click, use gimp_display_shell_scale() instead
	of local zoom logic.

2008-10-25  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	Bug 557870 – "Qmask" message popping up here and there

	* app/display/gimpdisplayshell-title.c
	(gimp_display_shell_format_title): use
	gimp_viewable_get_description() instead of gimp_object_get_name()
	for displaying the active drawable's name so the quick mask and
	the floating selection have the same names as in the
	layers/channels dialogs.

2008-10-24  Sven Neumann  <sven@gimp.org>

	Bug 557705 – compatibility with GEGL > 0.0.20

	* app/core/gimpdrawable-brightness-contrast.c
	* app/core/gimpdrawable-invert.c
	* app/tools/gimpbrightnesscontrasttool.c: choose GEGL operation
	names based on the GEGL version we are being used with.

2008-10-24  Sven Neumann  <sven@gimp.org>

	Bug 557705 – compatibility with GEGL > 0.0.20

	* app/gegl/gimp-gegl-utils.[ch]: added gimp_gegl_check_version(),
	a run-time GEGL version check.

	* app/core/gimpimagemap.c (gimp_image_map_apply): use the new
	function to determine the names of the GEGL ops to use.

2008-10-24  Sven Neumann  <sven@gimp.org>

        Bug 556896 – Dialogs don't get minimized with single image window

	* app/display/gimpdisplayshell.c
	* app/display/gimpdisplay-foreach.[ch]
	* app/widgets/gimpdialogfactory.[ch]: merged changes from trunk.
	Hide the toolbox and docks if the last display is iconified.
	Unhide them if a display is uniconified.

2008-10-24  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

        Bug 556248 – Scaling gives 'jagged' edges

        * app/paint-funcs/scale-region.c (scale): calculate pixel
        contributions based on pixel centers, not on pixel origins.

2008-10-23  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	* app/plug-in/gimppluginprocframe.c
	(gimp_plug_in_proc_frame_dispose): set proc_frame->procedure to
	NULL *after* calling gimp_plug_in_cleanup(). Fixes the crash on
	windows in bug #557061 (but not the bug).

2008-10-23  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* configure.in: removed check for Carbon and added a test for the
	target OS being Darwin instead.

	* app/config/gimpguiconfig.c: use PLATFORM_OSX instead of
	HAVE_CARBON to determine the default "web-browser" command.

2008-10-22  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* plug-ins/print/print-preview.c (print_preview_leave_notify_event):
	check the crossing mode and don't unset the "inside" flag when the
	event is caused by a pointer grab/ungrab.

2008-10-22  Martin Nordholts  <martinn@svn.gnome.org>

	Merged from trunk:

	Bug 556804 – Zoom drop down doesn't update

	* app/display/gimpdisplayshell-scale.c
	* app/display/gimpdisplayshell-callbacks.c: Fix calls to
	gimp_display_shell_scaled() when Resize window on zoom is enabled.

2008-10-22  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 524615 – Print not to scale

	* plug-ins/print/print.c: set the unit for dimensions on the Cairo
	context used for printing to GTK_UNIT_PIXELS.

	* plug-ins/print/print-draw-page.c (print_draw_page): changed the
	Cairo scale factors accordingly. Seems to fix printing on Windows.

2008-10-22  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/widgets/gimpprogressbox.c: set box->progress to NULL in
	destroy() and check for progress being NULL in various places so
	we don't crash on API calls after the widget is destroyed.

2008-10-22  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 555246 – gimp crashes when a file is opened while a preview is
	generating

	* app/widgets/gimpthumbbox.c: set box->progress to NULL in
	destroy() and check for progress being NULL in various places so
	we don't crash on API calls after the widget is destroyed.

2008-10-22  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 556741 – Alpha layer automatically added (in psd format) but
	not desired

	* plug-ins/file-psd/psd-save.c: applied patch from Dennis Ranke
	that flattens the projection for indexed images.

2008-10-22  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

        * app/widgets/gimpfiledialog.c: set dialog->progress to NULL in
        destroy() and check for progress being NULL in various places so
        we don't crash on API calls after the widget is destroyed.

2008-10-21  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/tools/gimpgegltool.c (gimp_param_spec_duplicate):
	GEGL_IS_PARAM_SPEC_PATH() became GEGL_IS_PARAM_SPEC_FILE_PATH()
	in GEGL 0.0.21.

	* app/tools/gimpgegltool.c (gimp_gegl_tool_dialog): for the
	combo-box, strip known prefixes from the GEGL operation names and
	use icons instead.

2008-10-21  Sven Neumann  <sven@gimp.org>

	* app/tools/gimpgegltool.c (gimp_gegl_tool_operation_blacklisted):
	make the operations blacklist work with GEGL >= 0.0.21.

2008-10-21  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/actions/file-commands.c (file_open_recent_cmd_callback): ref
	the GimpDisplay and GimpImageFile objects while holding a
	reference to them. Fixes a potential crash if GIMP is closed while
	the image is being loaded.

2008-10-20  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/widgets/gimperrorconsole.c (gimp_error_console_init): don't
	make the font size even smaller. We already use a smaller font in
	the dock windows.

2008-10-17  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* plug-ins/file-psd/psd-save.c (xfwrite): fixed handling of empty
	strings. Don't quit silently, write an error message to stderr at
	least.

2008-10-17  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/core/gimp.[ch]: added signal Gimp::image-opened to announce
	that an image has been loaded and a display was created for it.

	* app/file/file-open.c (file_open_with_proc_and_display): call
	gimp_image_opened() to emit the new signal.

	* app/gui/dbus-service.xml
	* app/gui/gimpdbusservice.[ch]: propagate the 'opened' signal to
	listeners of the "org.gimp.GIMP.UI" DBus service.

	* app/gui/gui-unique.c: formatting.

2008-10-14  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* themes/Default/images/stock-gegl.svg
	* themes/Default/images/stock-gegl-22.svg
	* themes/Default/images/stock-gegl-22.png: remove white from the
	shadow to render correctly on dark backgrounds.

2008-10-14  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	* app/widgets/gimpdialogfactory.c (gimp_dialog_factory_add_dialog):
	let new docks appear at the pointer position.

2008-10-13  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 556182 – Could you please explain a few strings [I18N]

	* plug-ins/pygimp/plug-ins/py-slice.py: added translator comments.

2008-10-10  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	* app/tools/gimpmovetool.c (gimp_move_tool_button_release): flush
	the image after setting active items back from temporarily
	selected ones. Fixes menu item sensitivity.

2008-10-09  Sven Neumann  <sven@gimp.org>

	Merged from trunk:

	Bug 555697 – build fails if configured with --without-libjpeg

	* plug-ins/Makefile.am: applied patch from Simon Zilliken that
	disables the build of the PSD plug-in if JPEG support is disabled.

2008-10-09  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	This is not exactly a bugfix-only commit, but fixing this bug
	was the original reason for all the curve and image map tool
	refactorings that went into 2.6. It would be silly not to
	fix it just because I simply forgot to hack the final step of
	enabling all the new code. The two new translatable strings are
	a PITA, sorry about that; but better than still only exporting
	the old curves and levels formats in 2.6.

	Bug 134956 – Curves tool doesn't save free curves

	* app/core/gimpmarshal.list
	* app/widgets/gimpsettingsbox.[ch]: add signal "file-dialog-setup"
	and emit it when the export/import file chooser is fully
	constructed. Callbacks can then do additional things to the
	dialog, like adding custom buttons.

	* app/tools/gimpcurvestool.h
	* app/tools/gimplevelstool.h: add boolean member
	"export_old_format".

	* app/tools/gimpcurvestool.c
	* app/tools/gimplevelstool.c (gimp_*_tool_dialog): connect to
	the settings box' "file-dialog-setup".

	(gimp_*_tool_export_setup): new callback which adds a toggle to
	the file choosers that allows to export to the old format.
	Default saving the new format, we defaulted to the old one before.

	(gimp_*_tool_settings_export): check the "export_old_format"
	boolean and only save the cruft format if it is TRUE; chain up
	otherwise, which generically saves the new format.

	* app/tools/gimplevelstool.c (gimp_levels_tool_settings_import):
	add the same file format detection code as in the curves tool
	so it transparently loads old and new levels files.

2008-10-09  Michael Natterer  <mitch@gimp.org>

	Merged from trunk:

	* app/gegl/gimpcurvesconfig.c (gimp_curves_config_save_cruft):
	when saving a curve of type GIMP_CURVE_FREE, don't use
	gimp_curve_get_point() because that returns nothing for free
	curves.

	(gimp_curves_config_load_cruft): reset the curve before loading it.

	* app/core/gimpcurve.c (gimp_curve_get_point): instead of above
	mentioned uninitialized nonsense, at least return -1,-1 for free
	curves.

2008-10-09  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.6.2 (interface age 2).

2008-10-09  Sven Neumann  <sven@gimp.org>

	* Made 2.6.1 release.

2008-10-08  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555587 – PSD file crashes PSD plug-in

	* plug-ins/file-psd/psd-load.c (add_merged_image): Handle
	img_a->alpha_names being NULL.

2008-10-08  Michael Natterer  <mitch@gimp.org>

	* libgimpwidgets/gimpruler.c: cosmetics.

2008-10-08  Michael Natterer  <mitch@gimp.org>

	Quick hack I needed for debugging and which doesn't hurt:

	* tools/test-clipboard.c (test_clipboard_paste): allow to paste to
	STDOUT by passing '-' as filename.

2008-10-08  Martin Nordholts  <martinn@svn.gnome.org>

	* plug-ins/file-psd/psd-load.c (add_layers): Decrease scope of
	comp_mode and initialize it.

2008-10-08  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555222 – PSD Load Plugin: unsupported compression mode

	* plug-ins/file-psd/psd-load.c (add_layers): Some PSD files can
	have channels where a compression method used for the channel data
	is specified, but without any actual channel data. Handle this
	case. Fix inspired by patch from Chris Mohler.

2008-10-08  Sven Neumann  <sven@gimp.org>

	* app/base/tile-cache.c: use a GMutex instead of a GStaticMutex
	as the latter needs API that causes compiler warnings about
	dereferencing of type-punned pointers.

2008-10-07  Michael Natterer  <mitch@gimp.org>

	Bug 555362 – gimp-remote is not working properly

	* app/widgets/gimptoolbox-dnd.c (gimp_toolbox_dnd_init): add the
	window itself as drop traget again so gimp-remote works.

2008-10-07  Michael Natterer  <mitch@gimp.org>

	* app/*/Makefile.am: reorder sections consistently. Remove
	redundant CFLAGS.

2008-10-06  Sven Neumann  <sven@gimp.org>

	Bug 555280 – some gif files will not be open

	* plug-ins/common/file-gif-load.c (GetCode): be more tolerant and
	continue loading with a warning message if there are bits missing
	at the end of the file.

2008-10-06  Sven Neumann  <sven@gimp.org>

	* app/paint-funcs/scale-region.c (scale_region): removed debug
	output.

2008-10-06  Michael Natterer  <mitch@gimp.org>

	* plug-ins/common/file-gih.c
	* plug-ins/common/file-xbm.c: setting a spin button's
	page_increment to 1 is of no use, set it to 10 instead.

2008-10-06  Michael Natterer  <mitch@gimp.org>

	* app/plug-in/plug-in-menu-path.c (menu_path_mappings): add a
	fallback mapping from <Toolbox> to <Image> so we catch really
	everything that wants to go to <Toolbox>.

2008-10-06  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpcontext.c (gimp_context_real_set_display): paranoia
	fix for hypothetical but harmful misbehavior: when setting the
	display from !=NULL to NULL, also set the image to NULL instead of
	relying on whatever obscure implicit behavior of other parts of
	GIMP which set a new display right away or make sure the image
	goes away together with the display.

2008-10-06  Michael Natterer  <mitch@gimp.org>

	* app/core/gimplayer.c (gimp_layer_add_mask): g_return_if_fail()
	on the mask's image being the same as the layer's image. The PDB
	already checks for this.

	* app/core/gimpimage.c (gimp_image_add_layer,channel,vectors):
	remove calls to gimp_item_set_image() because we only accept
	itmes of this image anyway.

2008-10-05  Michael Natterer  <mitch@gimp.org>

	* app/plug-in/gimpplugin-cleanup.c
	* app/vectors/gimpanchor.c: #include <glib-object.h>, not
	"glib-object.h".

2008-10-05  Michael Natterer  <mitch@gimp.org>

	* app/gegl/gegl-types.h: including ourselves serves no purpose.

2008-10-05  Michael Natterer  <mitch@gimp.org>

	Allow to "Open as Layers" in the empty display:

	* app/widgets/gimpfiledialog.[ch]: add member
	"gboolean open_as_layers". Rename gimp_file_dialog_set_image() to
	gimp_file_dialog_set_save_image() and add
	gimp_file_dialog_set_open_image() which sets both the image to
	load layers into and the "open_as_layers" boolean.

	* app/dialogs/file-open-dialog.c (file_open_dialog_response): look
	at dialog->open_as_layers instead of dialog->image to decide whether
	to open as layers (that's much more obvious). Enable open as layers
	without existing image by creating the image if it doesn't exist.

	* app/actions/file-commands.c (file_open_dialog_show): add "title"
	parameter and take the uri from the image if none was passed. Use the
	new gimp_file_dialog_set_open_image() instead of poking into the
	dialog struct. Change callers to pass the title and not get the
	uri from the image; instead always pass the image.

	* app/actions/file-actions.c (file_actions_update): keep
	"Open as Layers" sensitive even without image.

2008-10-05  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpimage-contiguous-region.c: some formatting cleanups.

	(find_contiguous_segment): changed to return gboolean not gint.

2008-10-05  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpruler.c: cache the PangoLayout. Use it not
	only for drawing the numbers, but also to calculate the size
	requisition depending on the actual font size.

2008-10-05  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpruler.c: instead of hardcoding a size
	request, implement GtkWidget::size_request and set the size
	depending on the font-scale.

2008-10-05  Sven Neumann  <sven@gimp.org>

	Bug 554890 – JPEG Save Options Dialog does not remember
	Subsampling mode

	* plug-ins/file-jpeg/jpeg.c (run): fixed problem introduced by the
	use of an enum for the subsampling factor.

2008-10-04  Michael Natterer  <mitch@gimp.org>

	* plug-ins/common/web-browser.c: return errors via return_vals
	instead of displaying them with g_message().

2008-10-04  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpruler.c: increased ruler font scale from
	X_SMALL to SMALL as it appears to be too small for many users.

	* themes/Default/gtkrc: follow that change here, but keep the
	ruler font extra small in the Small theme.

2008-10-04  Sven Neumann  <sven@gimp.org>

	* plug-ins/file-jpeg/jpeg-save.c: some cleanups to the subsampling
	code; in an attempt to fix bug #555031.

2008-10-04  Sven Neumann  <sven@gimp.org>

	* INSTALL: updated GTK+ requirement.

2008-10-04  Michael Natterer  <mitch@gimp.org>

	* configure.in: depend on GTK+ 2.12.5 so motion history events of
	extended input devices have proper timestamps needed by paint
	tools.

2008-10-04  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpruler.c: make the font scale factor
	configurable in gtkrc.

	* themes/Default/gtkrc
	* themes/Small/gtkrc: for documentation, add the default value here.

2008-10-03  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/web-browser.c (browser_open_url): removed
	trailing whitespace and corrected error message.

2008-10-03  Hans Breuer  <hans@breuer.org>

	* plug-ins/common/web-browser.c : when ShellExecute() is failing give
	the detailed (currently intentionally untranslated) error message via
	g_message()

	* **/makefie.msc gimpdefs.msc app/gimpcore.def : updated
	* app/core/gimpcurve.c : include <string.h> for memcmp()
	* app/gegl/gimpcurvesconfig.c : include <string.h> for strcmp()

2008-10-03  Sven Neumann  <sven@gimp.org>

	Bug 554966 – Gimp crashes creating a new image using a template

	* app/display/gimpdisplayshell-scale.c
	(gimp_display_shell_scale_update_scrollbars)
	(gimp_display_shell_scale_update_rulers): bail out early if
	shell->display is NULL.

2008-10-03  Michael Natterer  <mitch@gimp.org>

	Bug 554785 – Compile failure on uri-backend-libcurl

	* plug-ins/file-uri/uri-backend-libcurl.c: apply patch from Robby
	Workman which fixes the build for this file.

2008-10-03  Sven Neumann  <sven@gimp.org>

	* configure.in: removed custom error message from checks for babl
	and GEGL. The default error message is a lot more helpful.

2008-10-02  Sven Neumann  <sven@gimp.org>

	* app/tools/gimpgegltool.c (gimp_gegl_tool_operation_blacklisted):
	add "text" to the list of blacklisted operations.

2008-10-02  Michael Natterer  <mitch@gimp.org>

	Bug 554646 – Opening Help crashes GIMP with lqr-plugin installed

	* app/widgets/gimphelp.c (gimp_help_get_help_domains): need to
	assign (*foo)[i] and not *foo[i] of a gchar** returned via return
	value location.

2008-10-02  Michael Natterer  <mitch@gimp.org>

	* app/plug-in/gimppluginprocframe.c: keep a reference to the
	proc_frame's procedure. We can't asume it's always there since it
	could be a temporary one and its plug-in might die during
	procedure execution, taking the temp_proc with it.

2008-10-02  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 553534 – centering issues after image scaling and setting zoom
	to 100%

	* app/display/display-enums.h: Added a GimpZoomFocus enum with
	'best guess', 'pointer' or 'image center' values.

	* app/display/gimpdisplayshell-scale.[ch]
	(gimp_display_shell_scale): Take a GimpZoomFocus parameter and
	pass it on to

	(gimp_display_shell_scale_get_zoom_focus): which returns the
	requested zoom focus point if one was given, else makes a best
	guess.

	* app/actions/view-commands.c
	* app/display/gimpstatusbar.c
	* app/display/gimpnavigationeditor.c
	* app/display/gimpdisplayshell-callbacks.c
	* app/display/gimpdisplayshell-scale-dialog.c: For explicit-zoom
	commands like "zoom to 100%", always use the image center as the
	zoom focus point. For all other zooming, continue to use the
	best-guess method.

	* app/display/display-enums.c: Regenerated.

2008-10-02  Sven Neumann  <sven@gimp.org>

	Bug 554898 – Compile failure on uri-backend-wget.c

	* plug-ins/file-uri/uri-backend-wget.c: removed spurious commas
	that broke the build.

2008-10-01  Sven Neumann  <sven@gimp.org>

	* Makefile.am (EXTRA_DIST): added ChangeLog.pre-2-6 and NEWS.pre-2-6.

2008-10-01  Sven Neumann  <sven@gimp.org>

	* tools/gimptool.c: create the target directory and intermediate
	parent directories as needed. Restores the behavior of the
	gimptool shell script.

2008-10-01  Sven Neumann  <sven@gimp.org>

	* menus/Makefile.am (%.xml): added a dependency on configure.in to
	make sure that the image-menu.xml file is rebuilt when the version
	number is changed.

2008-10-01  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/gimpplugin.c
	* app/widgets/gtkscalebutton.c: : Don't #define _GNU_SOURCE on
	Windows as it confuses newest mingw headers.

2008-10-01  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.6.1 (interface age 1).

2008-09-30  Sven Neumann  <sven@gimp.org>

	* Made 2.6.0 release.

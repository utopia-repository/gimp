Description: fix denial of service and possible code execution via
 malformed PSP image file
Origin: upstream, http://git.gnome.org/browse/gimp/commit?id=f657361db04de69ce003328724c59e3f942d7d15

Index: gimp-2.6.11/plug-ins/common/file-psp.c
===================================================================
--- gimp-2.6.11.orig/plug-ins/common/file-psp.c	2011-06-08 10:31:55.406816426 -0400
+++ gimp-2.6.11/plug-ins/common/file-psp.c	2011-06-08 10:32:06.516816421 -0400
@@ -1246,7 +1246,7 @@
             fread (buf, runcount, 1, f);
 
           /* prevent buffer overflow for bogus data */
-          runcount = MIN (runcount, endq - q);
+          runcount = MIN (runcount, (endq - q) / bytespp);
 
           if (bytespp == 1)
             {
